<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-9BRBX45HVB"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-9BRBX45HVB');
    </script>
    
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Installation &mdash; Genv 1.3.0 documentation</title><link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/language_data.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Usage" href="usage.html" />
    <link rel="prev" title="Overview" href="overview.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            Genv
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption"><span class="caption-text">Start Here</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../overview/overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../overview/installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../overview/quickstart.html">Quick start</a></li>
</ul>
<p class="caption"><span class="caption-text">Usage</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../usage/usage.html">Usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="../usage/advanced-usage.html">Advanced Usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="../usage/enforcement.html">Enforcement</a></li>
<li class="toctree-l1"><a class="reference internal" href="../usage/monitoring.html">Monitoring</a></li>
<li class="toctree-l1"><a class="reference internal" href="../usage/python-sdk.html">Python SDK</a></li>
</ul>
<p class="caption"><span class="caption-text">Remote Usage</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="overview.html">Overview</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Installation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#overview">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="#local-hosts">Local Hosts</a></li>
<li class="toctree-l2"><a class="reference internal" href="#remote-hosts">Remote Hosts</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#ssh-daemon-configuration">SSH Daemon Configuration</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="usage.html">Usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="enforcement.html">Enforcement</a></li>
<li class="toctree-l1"><a class="reference internal" href="monitoring.html">Monitoring</a></li>
</ul>
<p class="caption"><span class="caption-text">Container Toolkit</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../docker/overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../docker/installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../docker/quickstart.html">Quick start</a></li>
<li class="toctree-l1"><a class="reference internal" href="../docker/usage.html">Usage</a></li>
</ul>
<p class="caption"><span class="caption-text">Development</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../development/development.html">Development</a></li>
<li class="toctree-l1"><a class="reference internal" href="../development/reference.html">Reference</a></li>
</ul>
<p class="caption"><span class="caption-text">About</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../about/changelog.html">Changelog</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Genv</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Installation</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/remote/installation.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="section" id="installation">
<span id="remote-installation"></span><h1>Installation<a class="headerlink" href="#installation" title="Permalink to this headline">¶</a></h1>
<div class="contents topic" id="contents">
<p class="topic-title">Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#installation" id="id2">Installation</a></p>
<ul>
<li><p><a class="reference internal" href="#overview" id="id3">Overview</a></p></li>
<li><p><a class="reference internal" href="#local-hosts" id="id4">Local Hosts</a></p></li>
<li><p><a class="reference internal" href="#remote-hosts" id="id5">Remote Hosts</a></p></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="overview">
<span id="remote-installation-overview"></span><h2>Overview<a class="headerlink" href="#overview" title="Permalink to this headline">¶</a></h2>
<p>Remote features in Genv are based on running <code class="code docutils literal notranslate"><span class="pre">genv</span></code> commands on remote hosts over SSH.
This means that Genv should be installed on all local and remote hosts, and that all local hosts should have SSH access to all remote hosts.</p>
<p>Genv uses commands similar to <code class="code docutils literal notranslate"><span class="pre">ssh</span> <span class="pre">&lt;host&gt;</span></code> for remote execution.
Therefore, authentication must not be interactive using passwords so that the <code class="code docutils literal notranslate"><span class="pre">ssh</span></code> commands Genv uses would work without additional arguments.</p>
<p>You can follow <a class="reference external" href="https://superuser.com/a/8110">this</a> to set up your SSH so you don’t have to type passwords.
It is recommended to use SSH keys.
The identity file and login user should be configured in the SSH configuration file at <code class="code docutils literal notranslate"><span class="pre">~/.ssh/config</span></code>.</p>
<p>Genv <a class="reference internal" href="enforcement.html"><span class="doc">remote enforcement features</span></a> use commands similar to <code class="code docutils literal notranslate"><span class="pre">ssh</span> <span class="pre">&lt;host&gt;</span> <span class="pre">sudo</span></code> for querying the environment variables of processes or terminating processes.
Therefore, Linux users that want to use these features need to have passwordless <code class="code docutils literal notranslate"><span class="pre">sudo</span></code> permissions on all remote machines.</p>
<p>Genv also sends environment variables over SSH by passing <code class="code docutils literal notranslate"><span class="pre">-o</span> <span class="pre">SendEnv</span></code> to the <code class="code docutils literal notranslate"><span class="pre">ssh</span></code> command.
Those environment variables must be explicitly accepted on all remote hosts by <a class="reference internal" href="#ssh-daemon-configuration"><span class="std std-ref">configuring</span></a> the SSH daemon on the remote hosts.</p>
</div>
<div class="section" id="local-hosts">
<h2>Local Hosts<a class="headerlink" href="#local-hosts" title="Permalink to this headline">¶</a></h2>
<p>On local hosts, <a class="reference internal" href="../overview/installation.html"><span class="doc">install</span></a> Genv if not already installed.
This is how you will run <code class="code docutils literal notranslate"><span class="pre">genv</span> <span class="pre">remote</span></code> commands.</p>
<p>Then, make sure you have SSH access to all remote hosts and that the SSH configuration is set properly.
You can verify that using a command similar to this:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>ssh &lt;host&gt; nvidia-smi
</pre></div>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>It is important that you verify the SSH access.
If you can’t access any of the remote hosts using a command similar to the one above, <code class="code docutils literal notranslate"><span class="pre">genv</span> <span class="pre">remote</span></code> commands will not work properly.</p>
</div>
</div>
<div class="section" id="remote-hosts">
<h2>Remote Hosts<a class="headerlink" href="#remote-hosts" title="Permalink to this headline">¶</a></h2>
<p>On remote hosts, Genv should be installed as root <a class="reference internal" href="../overview/installation.html#install-using-pip"><span class="std std-ref">using</span></a> <code class="code docutils literal notranslate"><span class="pre">pip</span></code> with the following command:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>sudo pip install genv
</pre></div>
</div>
<p>You can verify the setup by running a command similar to this from your local machine:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>$ ssh &lt;host&gt; sudo genv
usage: genv <span class="o">[</span>-h<span class="o">]</span> SUBCOMMAND ...

Query and control Genv on this machine or in a cluster
...
</pre></div>
</div>
<div class="section" id="ssh-daemon-configuration">
<span id="id1"></span><h3>SSH Daemon Configuration<a class="headerlink" href="#ssh-daemon-configuration" title="Permalink to this headline">¶</a></h3>
<p>Afterward, it is required to edit the configuration of the SSH daemon.</p>
<p>Genv uses SSH for communication, and relies on sending environment variables from local hosts to remote hosts by passing <code class="code docutils literal notranslate"><span class="pre">-o</span> <span class="pre">SendEnv</span></code> to the <code class="code docutils literal notranslate"><span class="pre">ssh</span></code> command.</p>
<p>Those environment variables must be explicitly accepted on all remote hosts by modifying the SSH daemon configuration file.</p>
<p>First, add <code class="code docutils literal notranslate"><span class="pre">GENV_*</span></code> to field <code class="code docutils literal notranslate"><span class="pre">AcceptEnv</span></code> in <code class="code docutils literal notranslate"><span class="pre">/etc/ssh/sshd_config</span></code>.
You can do this with the following command (you will probably need to use <code class="code docutils literal notranslate"><span class="pre">sudo</span></code> here):</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>sed -i <span class="s2">&quot;/^AcceptEnv/s/</span>$<span class="s2">/ GENV_*/&quot;</span> /etc/ssh/sshd_config
</pre></div>
</div>
<p>You can verify that it worked using the command:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>grep GENV /etc/ssh/sshd_config
</pre></div>
</div>
<p>Then, restart the SSH daemon using the following command (you will probably need to use <code class="code docutils literal notranslate"><span class="pre">sudo</span></code> here as well):</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>systemctl restart ssh
</pre></div>
</div>
<p>You can then test that everything is set up properly by running the following command from a local host:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span><span class="nv">GENV_TEST</span><span class="o">=</span><span class="s2">&quot;ilovegpus&quot;</span> ssh -o <span class="nv">SendEnv</span><span class="o">=</span>GENV_TEST &lt;host&gt; env <span class="p">|</span> grep GENV
</pre></div>
</div>
</div>
</div>
</div>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="overview.html" class="btn btn-neutral float-left" title="Overview" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="usage.html" class="btn btn-neutral float-right" title="Usage" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022-2023, Run.ai.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>