<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-9BRBX45HVB"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-9BRBX45HVB');
    </script>
    
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Reference &mdash; Genv 0.10.1 documentation</title><link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/language_data.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Changelog" href="../about/changelog.html" />
    <link rel="prev" title="Development" href="development.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            Genv
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption"><span class="caption-text">Start Here</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../overview/overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../overview/installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../overview/quickstart.html">Quick start</a></li>
</ul>
<p class="caption"><span class="caption-text">Usage</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../usage/usage.html">Usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="../usage/advanced-usage.html">Advanced Usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="../usage/enforcement.html">Enforcement</a></li>
<li class="toctree-l1"><a class="reference internal" href="../usage/monitoring.html">Monitoring</a></li>
</ul>
<p class="caption"><span class="caption-text">Remote Usage</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../remote/overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../remote/installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../remote/usage.html">Usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="../remote/enforcement.html">Enforcement</a></li>
<li class="toctree-l1"><a class="reference internal" href="../remote/monitoring.html">Monitoring</a></li>
</ul>
<p class="caption"><span class="caption-text">Container Toolkit</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../docker/overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../docker/installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../docker/quickstart.html">Quick start</a></li>
<li class="toctree-l1"><a class="reference internal" href="../docker/usage.html">Usage</a></li>
</ul>
<p class="caption"><span class="caption-text">Development</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="development.html">Development</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Reference</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#files">Files</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#envs-json">envs.json</a></li>
<li class="toctree-l3"><a class="reference internal" href="#devices-json">devices.json</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#environment-variables">Environment Variables</a></li>
<li class="toctree-l2"><a class="reference internal" href="#shims">Shims</a></li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">About</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../about/changelog.html">Changelog</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Genv</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Reference</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/development/reference.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="section" id="reference">
<h1>Reference<a class="headerlink" href="#reference" title="Permalink to this headline">¶</a></h1>
<div class="contents topic" id="contents">
<p class="topic-title">Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#reference" id="id6">Reference</a></p>
<ul>
<li><p><a class="reference internal" href="#files" id="id7">Files</a></p></li>
<li><p><a class="reference internal" href="#environment-variables" id="id8">Environment Variables</a></p></li>
<li><p><a class="reference internal" href="#shims" id="id9">Shims</a></p></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="files">
<span id="id1"></span><h2>Files<a class="headerlink" href="#files" title="Permalink to this headline">¶</a></h2>
<p>Genv uses JSON files to keep its state.
These files are queried and modified by <code class="code docutils literal notranslate"><span class="pre">genv</span></code> commands.</p>
<p>You can take a look at the files using the command:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>cat <span class="si">${</span><span class="nv">GENV_TMPDIR</span><span class="k">:-</span><span class="p">/var/tmp/genv</span><span class="si">}</span>/*.json
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>These state files are saved under <code class="code docutils literal notranslate"><span class="pre">/var/tmp/genv</span></code> by default.
This can be configured with the environment variable <code class="code docutils literal notranslate"><span class="pre">GENV_TMPDIR</span></code>.</p>
</div>
<p>These files are created by Genv on the first use as well as the temp directory.
Genv makes sure that any Linux user would have permissions to these files.</p>
<p>This can be seen with the following command:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>ls -la <span class="si">${</span><span class="nv">GENV_TMPDIR</span><span class="k">:-</span><span class="p">/var/tmp/genv</span><span class="si">}</span>
</pre></div>
</div>
<p>You can see that the directory was created with <code class="code docutils literal notranslate"><span class="pre">rwxrwxrwx</span></code> and the files with <code class="code docutils literal notranslate"><span class="pre">rw-rw-rw</span></code>.</p>
<hr class="docutils" />
<div class="section" id="envs-json">
<h3>envs.json<a class="headerlink" href="#envs-json" title="Permalink to this headline">¶</a></h3>
<p>Information about active environments and their configuration.</p>
</div>
<hr class="docutils" />
<div class="section" id="devices-json">
<h3>devices.json<a class="headerlink" href="#devices-json" title="Permalink to this headline">¶</a></h3>
<p>Information about device attachments.</p>
</div>
</div>
<div class="section" id="environment-variables">
<span id="id2"></span><h2>Environment Variables<a class="headerlink" href="#environment-variables" title="Permalink to this headline">¶</a></h2>
<p><code class="code docutils literal notranslate"><span class="pre">GENV_BYPASS</span></code></p>
<p>Bypass shim behaviors and use similar behavior to the original applications.
Default is <code class="code docutils literal notranslate"><span class="pre">0</span></code>.</p>
<hr class="docutils" />
<p><code class="code docutils literal notranslate"><span class="pre">GENV_TERMINATE_PROCESSES</span></code></p>
<p>Control whether to actually terminate enforced processes or not.
Default is <code class="code docutils literal notranslate"><span class="pre">1</span></code>.</p>
<hr class="docutils" />
<p><code class="code docutils literal notranslate"><span class="pre">GENV_MOCK_COMPUTE_APPS_GPU_MEMORY</span></code></p>
<p>Used GPU memory for compute apps in the <code class="code docutils literal notranslate"><span class="pre">nvidia-smi</span></code> mock shim.
Default is <code class="code docutils literal notranslate"><span class="pre">42mi</span></code>.</p>
<hr class="docutils" />
<p><code class="code docutils literal notranslate"><span class="pre">GENV_MOCK_COMPUTE_APPS_PROCESS_NAME</span></code></p>
<p>Name of processes to be considered as compute apps in the <code class="code docutils literal notranslate"><span class="pre">nvidia-smi</span></code> mock shim.
Default is <code class="code docutils literal notranslate"><span class="pre">sleep</span></code> (e.g. <code class="code docutils literal notranslate"><span class="pre">sleep</span> <span class="pre">infinity</span></code>).</p>
<hr class="docutils" />
<p><code class="code docutils literal notranslate"><span class="pre">GENV_MOCK_DEVICE_COUNT</span></code></p>
<p>Device count in the <code class="code docutils literal notranslate"><span class="pre">nvidia-smi</span></code> mock shim.
Default is <code class="code docutils literal notranslate"><span class="pre">2</span></code>.</p>
<hr class="docutils" />
<p><code class="code docutils literal notranslate"><span class="pre">GENV_MOCK_DEVICE_TOTAL_MEMORY</span></code></p>
<p>Total device memory in the <code class="code docutils literal notranslate"><span class="pre">nvidia-smi</span></code> mock shim.
Default is <code class="code docutils literal notranslate"><span class="pre">16g</span></code>.</p>
<hr class="docutils" />
<p><code class="code docutils literal notranslate"><span class="pre">GENV_MOCK_DEVICE_USED_MEMORY</span></code></p>
<p>Used device memory in the <code class="code docutils literal notranslate"><span class="pre">nvidia-smi</span></code> mock shim.
Default is <code class="code docutils literal notranslate"><span class="pre">10mi</span></code>.</p>
<hr class="docutils" />
<p><code class="code docutils literal notranslate"><span class="pre">GENV_TMPDIR</span></code></p>
<p>Path of the temp directory where all state JSON files are stored.
Default is <code class="code docutils literal notranslate"><span class="pre">/var/tmp/genv</span></code>.</p>
</div>
<div class="section" id="shims">
<span id="id3"></span><h2>Shims<a class="headerlink" href="#shims" title="Permalink to this headline">¶</a></h2>
<p>A shim <a class="footnote-reference brackets" href="#id5" id="id4">1</a> is a small application that runs instead of the originally intended one and acts as a middleware.
It manipulates the input and output of the real application, and provides an easy way to de-facto change the behavior of the original application.</p>
<hr class="docutils" />
<p><code class="code docutils literal notranslate"><span class="pre">docker</span></code></p>
<p>This shim modifies the argument <code class="code docutils literal notranslate"><span class="pre">--gpus</span></code> if passed.</p>
<p>When <code class="code docutils literal notranslate"><span class="pre">all</span></code> is passed, this shim passes the indices of all the devices that are attached to the environment.
When a device count is passed (e.g. <code class="code docutils literal notranslate"><span class="pre">--gpus</span> <span class="pre">2</span></code>), this shim passes indices of this amount of devices that are attached to the environment.
Any other value is not supported at the moment.</p>
<hr class="docutils" />
<p><code class="code docutils literal notranslate"><span class="pre">nvidia-smi</span></code></p>
<p>By default, <code class="code docutils literal notranslate"><span class="pre">nvidia-smi</span></code> shows information about all GPUs and processes.</p>
<p>It supports showing information about some of the devices by passing the argument <code class="code docutils literal notranslate"><span class="pre">--id</span></code> and specifying GPU indices.
It is also good to note that <code class="code docutils literal notranslate"><span class="pre">nvidia-smi</span></code> ignores the environment variable <code class="code docutils literal notranslate"><span class="pre">CUDA_VISIBLE_DEVICES</span></code> as it uses NVML and not CUDA.</p>
<p>This shim passes the argument <code class="code docutils literal notranslate"><span class="pre">--id</span></code> to <code class="code docutils literal notranslate"><span class="pre">nvidia-smi</span></code> and specifies the device indices that are attached to this environment.</p>
<p>It also filters out processes that are not from the current environment, and shows GPU memory information that is relevant only for this environment, by summing the used GPU memory of all processes in this environment.</p>
<dl class="footnote brackets">
<dt class="label" id="id5"><span class="brackets"><a class="fn-backref" href="#id4">1</a></span></dt>
<dd><p><a class="reference external" href="https://en.wikipedia.org/wiki/Shim_(computing)">Shim (computing) - Wikipedia</a></p>
</dd>
</dl>
</div>
</div>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="development.html" class="btn btn-neutral float-left" title="Development" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../about/changelog.html" class="btn btn-neutral float-right" title="Changelog" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022-2023, Run.ai.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>